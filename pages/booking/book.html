<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../../assets/css/book.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
        integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
        crossorigin="anonymous" referrerpolicy="no-referrer">
</head>

<body>
    <div class="hole-content">
        <!-- nav bar -->
        <div class="menu-bar">
            <img src="../../assets/images/Screenshot__63_-removebg-preview.png" alt="logo">
            <ul class="main">
                <li class="dropdown">
<a href="index.html">
Home <i class="fas fa-caret-down"></i>
</a>
</li>
                <!-- <li><a href="../upload/upload.html">For artist</a></li> -->
                <li>
<a href="../booking/start_booking.html">Book here</a>
</li>
                <!-- <li><a href="wishlist.html">Wishlist</a></li> -->
                <li>
<a href="../Login/login.html">
 <i class="fa-solid fa-user"></i>login
</a>
</li>
                <li>
<a href="../profile_of_user.html">
 <img src="../../assets/images/IMG20200903161128.jpg" class="my-profile-img">
</a>
</li>
            </ul>
        </div>
        <!-- nav bar ends -->

    

                <a href="#content-2"><button class="result">View result</button></a>

            </div>
    

            <!-- Main content profile -->
            <div id="content-2">

                <div class="main-content">

                    
                    <div class="head">
                        <p class="count"></p>
                        <i class="fa-solid fa-magnifying-glass" id="glass"></i><input type="search" id="search"
                            placeholder="search artist...">
                        <img src="../../assets/images/GridColoured.ade2802b.svg" id="grid" alt="grid"> 
                         <p class="grid">GRID</p>
                    </div>
                    <div class="box">
                        <!-- <div class="one">
                            <div class="pic">
                                <img class="profile" src="../../assets/images/Makeup.jpg"  alt="Makeup">
                            </div>

                            <p>Magitough makeup</p>

                            <p> <i id="star" class="fa-solid fa-star"></i> 5.0(51reviews)</p>
                            <div class="local">
                                <img src="../../assets/images/map.png" class="map"  alt="Map">
                                <p class="chennai">chennai</p>
                            </div>
                            <p>Bridal makeup prize</p>
                            <p><strong>Rs 15,000</strong></p>
                            <a href="../booking/book2.html"> <button>See more</button></a>
                        </div>
                        <div class="one">
                            <div class="pic">
                                <img class="profile" src="../../assets/images/Makeup2.jpg"  alt="Makepup2">
                            </div>

                            <p>wedme good makeup</p>

                            <p> <i id="star" class="fa-solid fa-star"></i> 5.0(51reviews)</p>
                            <div class="local">
                                <img src="../../assets/images/map.png" class="map"  alt="Map3">
                                <p class="chennai">chennai</p>
                            </div>
                            <p>Bridal makeup prize</p>
                            <p><strong>Rs 18,000</strong></p>
                            
                            <a href="../booking/book2.html"> <button>See more</button></a>
                        </div>
                        <div class="one">
                            <div class="pic">
                                <img class="profile" src="../../assets/images/DwYU5PJUwAAP2f1.jpg"  alt="makeup4">
                            </div>

                            <p>Glow bridy makeup</p>

                            <p> <i id="star" class="fa-solid fa-star"></i> 5.0(51reviews)</p>
                            <div class="local">
                                <img src="../../assets/images/map.png" class="map"  alt="Makeup5">
                                <p class="chennai">chennai</p>
                            </div>
                            <p>Bridal makeup prize</p>
                            <p><strong>Rs 17,000</strong></p>
                            <a href="../booking/book2.html"> <button>See more</button></a>
                        </div> -->




                    </div>
                    

                </div>
            </div>
        </div>
        <!-- main content ends -->
    </div>
    </div>

    <script>  

const urlParams = new URLSearchParams(window.location.search);
const dateParam = urlParams.get("date"); 


console.log(dateParam);
const [year, month, day] = dateParam.split("-").map(Number);

const place = urlParams.get("place");

const records = JSON.parse(localStorage.getItem("card_data"));

let filteredArtistsByPlace = records.filter((artist) => {
  return artist.localty === place;
});

filteredArtistsByPlace.forEach((artist) => {
  console.log(artist.selected_dates);
});


let filteredArtistsByDate = filteredArtistsByPlace.filter((artist) => {
  const hasSelectedDates =
    artist.selected_dates && artist.selected_dates.length > 0;

  const hasBookingRecords =
    artist.booking_records && artist.booking_records.length > 0;

  const selectedDatesMatch = hasSelectedDates
    ? artist.selected_dates.some((selectedDate) => {
        if (typeof selectedDate !== 'string') {
          return false;
        }
        const [selectedYear, selectedMonth, selectedDay] = selectedDate.split('-');
        return (
          Number(selectedYear) === year &&
          Number(selectedMonth) === month &&
          Number(selectedDay) === day
        );
      })
    : false;

  const bookingRecordsMatch = hasBookingRecords
    ? artist.booking_records.some((bookingRecord) => {
        if (typeof bookingRecord.event_date !== 'string') {
          return false;
        }
        const [eventYear, eventMonth, eventDay] = bookingRecord.event_date.split('-');
        return (
          Number(eventYear) === year &&
          Number(eventMonth) === month &&
          Number(eventDay) === day
        );
      })
    : false;

  return !selectedDatesMatch && !bookingRecordsMatch;
});






// console.log()
console.log(filteredArtistsByDate.length)
document.querySelector(".count").textContent = `${filteredArtistsByDate.length} results were found `;

if (filteredArtistsByDate.length === 0) {
  const noResultsDiv = document.createElement("div");
  noResultsDiv.innerText = "No artists are available on that date.";
  document.querySelector(".box").appendChild(noResultsDiv);
  
}


// else {
//   const gridIcon = document.getElementById("grid");
//   const boxDiv = document.querySelector(".box");

//   gridIcon.addEventListener("click", () => {
//     if (!boxDiv.classList.contains("grid-view")) {
//       boxDiv.classList.add("grid-view");
//     } else {
//       boxDiv.classList.remove("grid-view");
//     }
//   });

//   for (const artist of filteredArtistsByDate) {
//     if (!boxDiv.classList.contains("grid-view")) {
    
//           const div_1 = document.createElement("div");
//     div_1.setAttribute("class", "one");
//     document.querySelector(".box").prepend(div_1);

//     const div_2 = document.createElement("div");
//     div_2.setAttribute("class", "pic");
//     document.querySelector(".one").append(div_2);

//     const img_1 = document.createElement("img");
//     img_1.setAttribute("src", artist.image_url);
//     img_1.setAttribute("class", "profile");
//     img_1.setAttribute("alt", "Makeup");
//     document.querySelector(".pic").append(img_1);

//     const p_1 = document.createElement("p");
//     p_1.innerHTML =artist.name;
//     document.querySelector(".one").append(p_1);

//     const p_2 = document.createElement("p");
//     p_2.innerHTML = "5.0(51reviews)";
//     p_2.setAttribute("class", "para");
//     document.querySelector(".one").append(p_2);

//     const i = document.createElement("i");
//     i.setAttribute("class", "fa-solid fa-star");
//     i.setAttribute("id", "star");
//     document.querySelector(".para").append(i);

//     const div_3 = document.createElement("div");
//     div_3.setAttribute("class", "local");
//     document.querySelector(".one").append(div_3);

//     const img_2 = document.createElement("img");
//     img_2.setAttribute("src", "../../assets/images/map.png");
//     img_2.setAttribute("alt", "map");
//     img_2.setAttribute("class", "map");
//     document.querySelector(".local").append(img_2);

//     const p_3 = document.createElement("p");
//     p_3.innerHTML = artist.localty;
//     p_3.setAttribute("class", "chennai");
//     document.querySelector(".local").append(p_3);

//     const p_4 = document.createElement("p");
//     p_4.innerHTML = "Minimum makeup prize";
//     document.querySelector(".one").append(p_4);

//     const p_5 = document.createElement("p");
//     p_5.innerHTML = "₹ " + artist.ruppi;
//     p_5.setAttribute("class", "Price");
//     document.querySelector(".one").append(p_5);

//     const a_1 = document.createElement("a");
//     a_1.setAttribute("href", `../booking/book2.html?name=${artist.name}&date=${year}-${month}-${day}`);
//     a_1.setAttribute("class", "anker");
//     document.querySelector(".one").append(a_1);

//     const button_1 = document.createElement("button");
//     button_1.innerHTML = "See more";
//     document.querySelector(".anker").append(button_1);

//     } else {
//       // Display content in grid view
//       boxDiv.innerHTML += `
//         <div class="grid_div">
//           <div class="card">
//             <div class="pic_grid">
//               <img src="${artist.image_url}" class="grid_image">
//             </div>
//             <div class="contnt_grid">
//               <p>${artist.name}</p>
//               <p>Ratings_reviews</p>
//               <p>${artist.localty}</p>
//               <p>${artist.ruppi}</p>
//               <button>see more</button>
//             </div>
//           </div>
//         </div>`;
//     }
//   }
// }
else {



  for (const artist of filteredArtistsByDate) {
    const div_1 = document.createElement("div");
    div_1.setAttribute("class", "one");
    document.querySelector(".box").prepend(div_1);

    const div_2 = document.createElement("div");
    div_2.setAttribute("class", "pic");
    document.querySelector(".one").append(div_2);

    const img_1 = document.createElement("img");
    img_1.setAttribute("src", artist.image_url);
    img_1.setAttribute("class", "profile");
    img_1.setAttribute("alt", "Makeup");
    document.querySelector(".pic").append(img_1);

    const p_1 = document.createElement("p");
    p_1.innerHTML =artist.name;
    document.querySelector(".one").append(p_1);

    const p_2 = document.createElement("p");
    p_2.innerHTML = "5.0(51reviews)";
    p_2.setAttribute("class", "para");
    document.querySelector(".one").append(p_2);

    const i = document.createElement("i");
    i.setAttribute("class", "fa-solid fa-star");
    i.setAttribute("id", "star");
    document.querySelector(".para").append(i);

    const div_3 = document.createElement("div");
    div_3.setAttribute("class", "local");
    document.querySelector(".one").append(div_3);

    const img_2 = document.createElement("img");
    img_2.setAttribute("src", "../../assets/images/map.png");
    img_2.setAttribute("alt", "map");
    img_2.setAttribute("class", "map");
    document.querySelector(".local").append(img_2);

    const p_3 = document.createElement("p");
    p_3.innerHTML = artist.localty;
    p_3.setAttribute("class", "chennai");
    document.querySelector(".local").append(p_3);

    const p_4 = document.createElement("p");
    p_4.innerHTML = "Minimum makeup prize";
    document.querySelector(".one").append(p_4);

    const p_5 = document.createElement("p");
    p_5.innerHTML = "₹ " + artist.ruppi;
    p_5.setAttribute("class", "Price");
    document.querySelector(".one").append(p_5);

    const a_1 = document.createElement("a");
    a_1.setAttribute("href", `../booking/book2.html?name=${artist.name}&date=${year}-${month}-${day}`);
    a_1.setAttribute("class", "anker");
    document.querySelector(".one").append(a_1);

    const button_1 = document.createElement("button");
    button_1.innerHTML = "See more";
    document.querySelector(".anker").append(button_1);




  }
}




//search filter for searching artist

      result_of_search= document.getElementById("search")
      result_of_search.addEventListener("input", (e) => {
      let word = e.target.value.toLowerCase();
      let dic = document.querySelectorAll(".one");
      console.log(word)
      dic.forEach(ex => {
        let child = ex.children[1].textContent.toLocaleLowerCase();
        if (child.startsWith(word)) {
          ex.style.display = "block"
        }
        else {
          ex.style.display = "none"
        }       
      })
      let count = document.querySelectorAll(".one[style='display: block;']").length;
      console.log(count)
  let countText = `${count} results are found`;
  document.querySelector(".count").textContent = countText;
//   document.querySelector(".count").style.display = "block";


    })
       </script>
    <script>

    //LOGGED IN DATA
    const isLoggedIn = localStorage.getItem("profile") !== null;

const loginLink = document.querySelector('a[href="../Login/login.html"]');
const profileLink = document.querySelector('a[href="../profile_of_user.html"]');

if (isLoggedIn) {
    loginLink.style.display = "none";
    profileLink.style.display = "block";
} else {
    loginLink.style.display = "block";
    profileLink.style.display = "none";
}




    </script>
</body>

</html>

